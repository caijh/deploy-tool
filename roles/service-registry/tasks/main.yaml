---
- name: Install Service-Registry
  k8s: 
    host: 'https://192.168.33.10:6443'
    api_key: 'eyJhbGciOiJSUzI1NiIsImtpZCI6InBYUVlrNVVieXV4ek5pWW0tenVwUFNkRTBnOFlWcTFiVkYzZHIxbDA2WjQifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYXNoYm9hcmQtYWRtaW4tdG9rZW4tNGZnd2YiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFzaGJvYXJkLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiMGJkY2QyY2ItMmMwNC00OTgzLWFiZjgtMjk4OGQ3ZDZkYTg0Iiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmRhc2hib2FyZC1hZG1pbiJ9.hqk-TC_l33CNDPnz9AeIRBRsCvew2QEK_9a2bnE9mBNF_9Aw5hnTjsYT9clTj9a3bTcESRghW-JaVqa0VtJc5icjOkEZ0hmHrHweKFDFlaoBRvfBWkz_lE0-bdEvWLk5Wzdto9N78gJNh5D74Y_PL2ZryTmQ8mxt-tgTlk9s-v45DIiGeJc-x5B6PlpnZTZGkOq_7S2JQAGi-m2PxNkZ716ZA2E2tz9OgPW-u5-MhRmASruFQqHukB6tbxtArjE5qs3pPCe-Jbaw1bv9ooTgRdceR1M99FS1Ky9pX7wgZ1LrUvYQg3p8jT1q6rRtwwdESbu1dQQWMWN1OKLYOPtxHg'
    state: present
    definition: "{{ lookup('template', 'templates/main.yaml') | to_yaml }}"
    validate:
      fail_on_error: yes
      strict: yes